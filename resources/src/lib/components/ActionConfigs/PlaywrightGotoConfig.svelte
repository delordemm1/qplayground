<script lang="ts">
  import { Label, Input, Select } from "flowbite-svelte";

  type PlaywrightGotoConfig = {
    url: string;
    timeout?: number;
    wait_until?: "load" | "domcontentloaded" | "networkidle";
  };

  let { config = $bindable() }: { config: PlaywrightGotoConfig } = $props();

  // Ensure config is always an object
  config = config ?? {};

  function applyDefaults(targetConfig: PlaywrightGotoConfig) {
    if (!targetConfig.url) targetConfig.url = "";
  }

  // Apply defaults immediately for initial render
  applyDefaults(config);

  $effect(() => {
    applyDefaults(config);
  });
</script>

<div class="space-y-4">
  <div>
    <Label for="goto-url" class="mb-2">URL *</Label>
    <Input
      id="goto-url"
      type="url"
      bind:value={config.url}
      placeholder="https://example.com"
      required
    />
  </div>

  <div>
    <Label for="goto-timeout" class="mb-2">Timeout (ms)</Label>
    <Input
      id="goto-timeout"
      type="number"
      bind:value={config.timeout}
      placeholder="30000"
      min={0}
    />
  </div>

  <div>
    <Label for="goto-wait-until" class="mb-2">Wait Until</Label>
    <Select id="goto-wait-until" bind:value={config.wait_until} items={[{ value: "", name: "(Default)" }, { value: "load", name: "Load" }, { value: "domcontentloaded", name: "DOM Content Loaded" }, { value: "networkidle", name: "Network Idle" }]} />
  </div>
</div>